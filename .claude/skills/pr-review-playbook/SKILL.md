---
name: pr-review-playbook
description: レビュー観点（正確性、保守性、性能、セキュリティ、テスト）を固定するプレイブックスキル。差分と変更理由を入力とし、指摘一覧（優先度付き）と最小修正提案を出力する。PR作成前およびマイルストーンごとに使用する。重大欠陥の見落としが減る（チェックが網羅的）ことを受入条件とする。
---

# PR Review Playbook

レビュー観点を固定し、品質を担保する。

## 入力

- 差分（git diff）
- 変更理由

## 出力

- 指摘一覧（優先度付き）
- 最小修正提案
- 承認 / 要修正 の判定

## 優先度

- **Critical**: 必ず修正（セキュリティ、データ損失、クラッシュ）
- **Major**: 強く推奨（バグ、仕様違反、保守性低下）
- **Minor**: 推奨（コードスタイル、軽微な改善）
- **Nitpick**: 任意（好み、軽微なスタイル）

## レビュー観点

### 1. 正確性
- 要件を満たしているか
- ロジックに誤りがないか
- エッジケースが考慮されているか

### 2. 保守性
- コードが読みやすいか
- 命名が適切か
- 責務が明確か
- 重複がないか

### 3. 性能
- 明らかな非効率がないか
- N+1 問題がないか
- 不要な処理がないか

### 4. セキュリティ
- 入力検証があるか
- 機密情報がログに出ていないか
- 認可が適切か
- OWASP Top 10 に該当しないか

### 5. テスト
- テストが追加されているか
- カバレッジが適切か
- テストが意味のある検証をしているか

## ワークフロー

1. 差分全体を把握する
2. 変更理由とタスク定義を確認する
3. 各観点でレビューを行う
4. 指摘を優先度順に整理する
5. 最小限の修正提案を添える
6. 承認 / 要修正 の判定を下す

## 出力フォーマット

```markdown
## レビュー結果

### 判定: [承認 / 要修正]

### 指摘一覧

#### Critical
- [ ] [指摘内容]
  - 修正提案: [提案]

#### Major
- [ ] [指摘内容]
  - 修正提案: [提案]

#### Minor
- [ ] [指摘内容]

#### Nitpick
- [指摘内容]

### 総評
[全体的なコメント]
```

## 受入条件

- 全ての変更ファイルを確認している
- 5つの観点（正確性・保守性・性能・セキュリティ・テスト）を確認している
- 指摘に優先度が付いている
- 修正提案が具体的
- 重大欠陥の見落としがない
